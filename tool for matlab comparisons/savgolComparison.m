%savgol test, sweep 1
rawData = [10.622701, 10.685064, 10.811692, 10.688583, 10.887390, 10.797409, 10.746269, 10.811608, 10.902945, 10.780086, 10.749742, 10.908122, 10.814869, 10.828547, 10.887683, 10.728690, 10.833145, 11.067073, 11.043278, 11.039386, 11.091691, 11.153873, 11.114600, 11.036674, 11.213064, 11.309932, 11.105683, 11.212055, 11.324126, 11.194699, 11.353987, 11.350740, 11.292644, 11.442810, 11.439925, 11.482235, 11.530317, 11.600945, 11.619031, 11.400206, 11.753139, 11.648222, 11.781803, 11.797832, 11.739770, 11.941082, 11.828091, 12.157527, 12.096933, 12.110010, 12.206010, 12.388506, 12.260824, 12.648261, 12.705714, 12.722179, 12.754862, 12.893028, 13.159175, 13.183230, 13.311389, 13.298972, 13.261604, 13.694345, 13.771741, 14.001879, 14.189768, 14.511730, 14.359793, 14.638225, 14.824602, 14.914421, 14.997834, 15.684181, 15.781509, 16.275709, 16.599232, 16.719099, 17.214252, 17.533026, 17.963692, 18.583456, 18.788620, 19.200493, 19.648212, 20.243040, 20.929434, 21.259766, 21.952223, 22.503075, 23.370432, 24.918806, 25.171230, 27.065788, 27.180111, 27.787876, 28.998455, 29.525824, 31.179409, 31.490416, 32.487705, 34.209385, 35.017632, 35.803844, 36.751629, 37.337452, 38.083050, 38.731632, 39.145710, 39.097286, 39.118252, 38.600292, 38.594673, 38.143532, 36.851486, 36.215759, 35.285809, 33.144527, 31.749477, 30.509886, 29.429501, 28.553759, 27.620716, 25.907400, 25.577999, 24.609949, 23.476007, 22.677389, 21.517937, 21.161259, 19.931110, 19.942099, 18.975761, 18.567039, 18.164619, 17.428867, 17.208427, 17.286226, 16.729990, 16.287188, 16.051325, 15.796345, 15.456290, 15.405236, 14.895143, 14.795584, 14.395524, 14.369744, 14.010384, 13.941030, 13.790119, 13.663849, 13.656402, 13.493700, 13.104727, 12.886893, 12.890328, 13.091658, 12.860380, 12.800608, 12.601340, 12.548893, 12.445310, 12.444828, 12.377852, 12.103253, 12.114568, 12.138745, 11.998631, 11.788012, 11.794188, 11.952522, 11.677851, 11.750690, 11.713306, 11.678294, 11.438836, 11.444407, 11.432587, 11.364266, 11.434116, 11.342859, 11.238228, 11.103382, 11.367911, 11.148427, 11.157647, 11.231358, 11.171824, 11.181418, 11.243023, 11.033014, 10.952828, 10.881493, 11.138855, 10.950686, 11.074336, 10.794726, 11.107287, 10.876784, 11.072885, 10.905889, 11.024071, 10.864059, 11.051531, 10.795092, 10.803169, 10.591374, 10.662008, 10.885164, 10.807120, 10.753461, 10.795931, 10.841900, 10.787424, 10.814193, 10.802969, 10.701277, 10.820682, 10.546778, 10.653350, 10.769685, 10.535284, 10.776764, 10.739217, 10.612684, 10.572164, 10.659692, 10.502118, 10.433316, 10.652619, 10.645733, 10.507947, 10.556618, 10.502070, 10.555065, 10.527785, 10.578192, 10.527130, 10.606975, 10.712130, 10.536406, 10.500002, 10.470071, 10.454396, 10.430950, 10.430219, 10.607625, 10.394053, 10.582440, 10.461887, 10.356397, 10.505668, 10.381385, 10.469771, 10.520262, 10.387793, 10.577419, 10.352968, 10.294890, 10.395078, 10.471552, 10.474617, 10.434118, 10.316442, 10.437953, 10.448010, 10.480718, 10.353670, 10.356996, 10.482037, 10.413630, 10.382499, 10.249657, 10.332000, 10.422174, 10.319706, 10.310604, 10.388857, 10.375589, 10.374058, 10.274459, 10.416360, 10.465050, 10.250622, 10.524909, 10.381805, 10.324562, 10.360604, 10.378771, 10.438423, 10.272150, 10.335931, 10.437474, 10.341777, 10.444112, 10.348996, 10.422782, 10.275411, 10.371153, 10.290133];

%mes_savgol.c's output
yourSavgolData = [10.629763, 10.696989, 10.746001, 10.779577, 10.800492, 10.811522, 10.815444, 10.817576, 10.811932, 10.834285, 10.820677, 10.811458, 10.814811, 10.821941, 10.838974, 10.876290, 10.916191, 10.957759, 10.999250, 11.030718, 11.086677, 11.129660, 11.133131, 11.147287, 11.164325, 11.185224, 11.210786, 11.225245, 11.255529, 11.282523, 11.294430, 11.322581, 11.374703, 11.424610, 11.437871, 11.484851, 11.502789, 11.541351, 11.588687, 11.604626, 11.652246, 11.669823, 11.714590, 11.771592, 11.835686, 11.898086, 11.950362, 12.005314, 12.066269, 12.157302, 12.257926, 12.338635, 12.424269, 12.506160, 12.623514, 12.747149, 12.867897, 12.945200, 13.048161, 13.117251, 13.227140, 13.342875, 13.503263, 13.642700, 13.787916, 13.970305, 14.157542, 14.305109, 14.475582, 14.607244, 14.791497, 15.012493, 15.243711, 15.512632, 15.832456, 16.129240, 16.490564, 16.870996, 17.244755, 17.582111, 17.965513, 18.374926, 18.811359, 19.285551, 19.735891, 20.169699, 20.735083, 21.269598, 22.026011, 22.843277, 23.657761, 24.538494, 25.374031, 26.334457, 27.250193, 28.089947, 28.948259, 29.828468, 30.808872, 31.761244, 32.854939, 33.884571, 34.858788, 35.848381, 36.697754, 37.553074, 38.149044, 38.563522, 38.953320, 39.116745, 39.071663, 38.932549, 38.523201, 37.863060, 36.984612, 35.923599, 34.712978, 33.495701, 32.105785, 30.783434, 29.573719, 28.370752, 27.320620, 26.354559, 25.417038, 24.416134, 23.492434, 22.590540, 21.760862, 21.048532, 20.273788, 19.591825, 19.037321, 18.545349, 18.113472, 17.681227, 17.341328, 16.941397, 16.671875, 16.362370, 16.091145, 15.815287, 15.518658, 15.213692, 14.976069, 14.739734, 14.495420, 14.285663, 14.124198, 13.962687, 13.817830, 13.628209, 13.493155, 13.346032, 13.240891, 13.114725, 13.003144, 12.889727, 12.788776, 12.736624, 12.681302, 12.589371, 12.482537, 12.383245, 12.304611, 12.199337, 12.135581, 12.048499, 11.971614, 11.899681, 11.863859, 11.826397, 11.761260, 11.704121, 11.651820, 11.607583, 11.548740, 11.493034, 11.433243, 11.380545, 11.338153, 11.298362, 11.281860, 11.247508, 11.215132, 11.211628, 11.202952, 11.203865, 11.169637, 11.150249, 11.094049, 11.098472, 11.043379, 11.017964, 10.984049, 10.973944, 10.960442, 10.987486, 10.979116, 10.988961, 10.969762, 10.988941, 10.961802, 10.922294, 10.860082, 10.839988, 10.791959, 10.771359, 10.750216, 10.751660, 10.748042, 10.789924, 10.798493, 10.835584, 10.814446, 10.771297, 10.774207, 10.739889, 10.709181, 10.696969, 10.692146, 10.672273, 10.674628, 10.678481, 10.644382, 10.638207, 10.616694, 10.592473, 10.590587, 10.553258, 10.549763, 10.550250, 10.551011, 10.541464, 10.544240, 10.556593, 10.551926, 10.567595, 10.584313, 10.581334, 10.574621, 10.539275, 10.533113, 10.499397, 10.488811, 10.478416, 10.458742, 10.477324, 10.473551, 10.466710, 10.472960, 10.456306, 10.461385, 10.457768, 10.459725, 10.431670, 10.433163, 10.434617, 10.430246, 10.424679, 10.406139, 10.397264, 10.414837, 10.413491, 10.426615, 10.429532, 10.419826, 10.422547, 10.416230, 10.404340, 10.403594, 10.382461, 10.362921, 10.352155, 10.353784, 10.352863, 10.333202, 10.334770, 10.361372, 10.358236, 10.360516, 10.370784, 10.385567, 10.386242, 10.376799, 10.392085, 10.392674, 10.382779, 10.369317, 10.358891, 10.372860, 10.351475, 10.378577, 10.380442, 10.380918, 10.384012, 10.382574, 10.374646, 10.358269, 10.331485, 10.292335];

windowSize = 13;  % Adjust as necessary
polynomialOrder = 3;  % Adjust as necessary
matlabSavgolData = smoothdata(rawData, 'sgolay', windowSize, 'Degree', polynomialOrder);

% Subplot 1: Plot original data and both smoothed data sets
subplot(2,1,1); % Two rows, one column, first plot
hold on;
plot(rawData, 'b', 'DisplayName', 'Original Data');
plot(yourSavgolData, 'r', 'DisplayName', 'Your Savgol Data');
plot(matlabSavgolData, 'g', 'DisplayName', 'MATLAB Savgol Data');

% Find and mark maxima for both datasets
[~, locsYourSavgol] = findpeaks(yourSavgolData);
[~, locsMatlabSavgol] = findpeaks(matlabSavgolData);
plot(locsYourSavgol, yourSavgolData(locsYourSavgol), 'r*', 'MarkerSize', 10);
plot(locsMatlabSavgol, matlabSavgolData(locsMatlabSavgol), 'g*', 'MarkerSize', 10);

legend;
title('Comparison of Filtered Data');
xlabel('Data Points');
ylabel('Values');
grid on;
hold off;

% Subplot 2: Plot the differences between yourSavgolData and matlabSavgolData
subplot(2,1,2); % Two rows, one column, second plot
differences = yourSavgolData - matlabSavgolData;
plot(differences, 'k', 'DisplayName', 'Difference');
title('Difference between Your Savgol Data and MATLAB Savgol Data');
xlabel('Data Points');
ylabel('Difference');
legend;
grid on;
